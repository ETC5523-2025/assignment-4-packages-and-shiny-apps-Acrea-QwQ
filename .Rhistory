library(ggplot2)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before discount" = "orange", "After discount" = "steelblue")) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
y = "",
x = ""
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
# æ¨¡æ‹Ÿ Average capital gain rate change æ•°æ®
set.seed(35285397)
## â€”â€” 1) ç”Ÿæˆå¹´åº¦æ•°æ®ï¼ˆä¸ä¹‹å‰é£æ ¼ä¸€è‡´ï¼‰ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
year <- c(
"1986-87","1989-90","1992-93","1995-96","1998-99",
"2001-02","2004-05","2007-08","2010-11","2013-14",
"2016-17","2019-20"
)
phase <- c(rep("Before discount", 5), rep("After discount", 7))
annual_value <- c(
runif(5, 2500, 6000),                                 # æ©™è‰²é˜¶æ®µï¼šç›¸å¯¹ç¨³å®š
seq(8000, 30000, length.out = 7) + rnorm(7, 0, 1500)  # è“è‰²é˜¶æ®µï¼šå¿«é€Ÿä¸Šå‡ï¼Œå¸¦å™ªå£°
)
capital_gain_annual <- data.frame(
fiscal_year = year,
phase = phase,
annual_value = pmax(annual_value, 0)  # é˜²æ­¢æç«¯å™ªå£°å˜è´Ÿ
)
## â€”â€” 2) æŒ‰å¹´æ‹†åˆ†ä¸º 4 ä¸ªå­£åº¦ï¼ˆå­£åº¦å’Œ = å¹´åº¦å€¼ï¼‰ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
# ç”¨â€œGammaâ†’å½’ä¸€åŒ–â€çš„åŠæ³•æ¨¡æ‹Ÿä¸å‡è¡¡å­£åº¦å æ¯”ï¼ˆç­‰ä»·äºç®€æ˜“ Dirichletï¼‰
split_into_quarters <- function(total, shape = c(1.2, 1.0, 1.0, 1.3)) {
g <- rgamma(4, shape = shape)
prop <- g / sum(g)
as.numeric(total * prop)
}
# å±•å¼€ä¸ºå­£åº¦æ•°æ®æ¡†
capital_gain_quarterly <- do.call(
rbind,
lapply(seq_len(nrow(capital_gain_annual)), function(i) {
qvals <- split_into_quarters(capital_gain_annual$annual_value[i])
data.frame(
fiscal_year = capital_gain_annual$fiscal_year[i],
phase       = capital_gain_annual$phase[i],
quarter     = factor(paste0("Q", 1:4), levels = paste0("Q", 1:4)),
`å­£åº¦å€¼`     = qvals,
annual_value = capital_gain_annual$annual_value[i]
)
})
)
## â€”â€” 3)ï¼ˆå¯é€‰ï¼‰ç”»å›å¹´åº¦æŸ±çŠ¶å›¾ï¼Œç¡®ä¿ä¸åŸé£æ ¼ä¸€è‡´ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
# æ³¨æ„ï¼šç»˜å›¾ä»ä½¿ç”¨ annual_valueï¼›å­£åº¦å€¼ä»…ä¿å­˜åœ¨æ•°æ®ä¸­ï¼Œå¿…è¦æ—¶å¯å•ç‹¬åˆ†æ
library(ggplot2)
ggplot(capital_gain_annual, aes(x = fiscal_year, y = annual_value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before discount" = "orange", "After discount" = "steelblue")) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(plot.title = element_text(face = "bold"),
legend.title = element_blank())
## â€”â€” 4) å®Œæ•´æ€§æ ¡éªŒï¼ˆå­£åº¦æ±‚å’Œ = å¹´åº¦ï¼‰ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
check <- aggregate(`å­£åº¦å€¼` ~ fiscal_year, capital_gain_quarterly, sum)
all.equal(check$`å­£åº¦å€¼`,
capital_gain_annual$annual_value[match(check$fiscal_year, capital_gain_annual$fiscal_year)])
# è¿”å› TRUE åˆ™è¡¨ç¤ºå­£åº¦å€¼ä¹‹å’Œç²¾ç¡®ç­‰äºå¹´åº¦å€¼
library(dplyr)
library(ggplot2)
# Fiscal years (same labels as your reference figure)
fiscal_year <- c(
"1986-87","1989-90","1992-93","1995-96","1998-99",
"2001-02","2004-05","2007-08","2010-11","2013-14",
"2016-17","2019-20"
)
# Phase split
phase <- c(rep("Before discount", 5), rep("After discount", 7))
# Simulate annual values (overall trend)
annual_value <- c(
runif(5, 2500, 6000),
seq(8000, 30000, length.out = 7) + rnorm(7, 0, 1200)
)
# Build annual data
annual_df <- data.frame(fiscal_year, phase, annual_value)
# Function to generate quarterly proportions (summing to 1)
generate_quarters <- function(total) {
w <- rgamma(4, shape = c(1.2, 1.0, 1.0, 1.4))
q_prop <- w / sum(w)
total * q_prop
}
# Expand to quarterly data
capital_gain_quarterly <- do.call(
rbind,
lapply(seq_len(nrow(annual_df)), function(i) {
q_values <- generate_quarters(annual_df$annual_value[i])
data.frame(
fiscal_year = annual_df$fiscal_year[i],
phase       = annual_df$phase[i],
quarter     = factor(paste0("Q", 1:4), levels = paste0("Q", 1:4)),
quarter_value = q_values
)
})
)
# Verify quarterly sums
check <- capital_gain_quarterly %>%
group_by(fiscal_year) %>%
summarise(sum_quarters = sum(quarter_value)) %>%
left_join(annual_df, by = "fiscal_year")
all.equal(check$sum_quarters, check$annual_value) # TRUE means sums match
ggplot(capital_gain_quarterly,
aes(x = fiscal_year, y = quarter_value, fill = quarter)) +
geom_col(position = "stack", width = 0.7) +
facet_wrap(~phase, scales = "free_x", nrow = 1) +
scale_fill_brewer(palette = "Blues") +
labs(
title = "Average capital gain rate change (with quarterly detail)",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL, fill = "Quarter"
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.position = "right",
axis.text.x = element_text(angle = 45, hjust = 1)
)
set.seed(35285397)
# Generate yearly sequence
years <- paste0(1986:2019, "-", substr(1987:2020, 3, 4))
# Label policy phase
phase <- ifelse(as.numeric(substr(years, 1, 4)) < 2000,
"Before 50% discount", "After 50% discount")
# Simulate yearly values
values <- c(
runif(sum(phase == "Before 50% discount"), 2500, 6000),
seq(7000, 30000, length.out = sum(phase == "After 50% discount")) +
rnorm(sum(phase == "After 50% discount"), 0, 1200)
)
# Combine into data frame
capital_gain <- data.frame(
year = years,
phase = phase,
value = pmax(values, 0)  # prevent negatives
)
# View sample
head(capital_gain)
tail(capital_gain)
# =====================
# Plot
# =====================
library(ggplot2)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% discount" = "orange",
"After 50% discount" = "steelblue")) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.title = element_blank()
)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% discount" = "orange",
"After 50% discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 2)]) +  # show label every 2 years
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank()
)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% discount" = "orange",
"After 50% discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank()
)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% discount" = "orange",
"After 50% discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
library(ggplot2)
library(scales)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% discount" = "orange",
"After 50% discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
scale_y_continuous(labels = label_dollar()) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
library(ggplot2)
library(scales)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% capital gain discount" = "orange",
"After 50% capital gain discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
scale_y_continuous(labels = label_dollar()) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
library(ggplot2)
library(scales)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50%  discount" = "orange",
"After 50% discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
scale_y_continuous(labels = label_dollar()) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
library(ggplot2)
library(scales)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% discount" = "orange",
"After 50% discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
scale_y_continuous(labels = label_dollar()) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
# æ¨¡æ‹Ÿ Average capital gain rate change æ•°æ®
set.seed(35285397)
# Generate yearly sequence
years <- paste0(1986:2019, "-", substr(1987:2020, 3, 4))
# Label policy phase
phase <- ifelse(as.numeric(substr(years, 1, 4)) < 2000,
"Before 50% capital gains discount", "After 50% capital gains discount")
# Simulate yearly values
values <- c(
runif(sum(phase == "Before 50% capital gains discount"), 2500, 6000),
seq(7000, 30000, length.out = sum(phase == "After 50% capital gains discount")) +
rnorm(sum(phase == "After 50% capital gains discount"), 0, 1200)
)
# Combine into data frame
capital_gain <- data.frame(
year = years,
phase = phase,
value = pmax(values, 0)  # prevent negatives
)
# View sample
head(capital_gain)
tail(capital_gain)
# =====================
# Plot
# =====================
library(ggplot2)
library(scales)
ggplot(capital_gain, aes(x = year, y = value, fill = phase)) +
geom_col(width = 0.7) +
scale_fill_manual(values = c("Before 50% capital gains discount" = "orange",
"After 50% capital gains discount" = "steelblue")) +
scale_x_discrete(breaks = years[seq(1, length(years), by = 3)]) +  # show label every 2 years
scale_y_continuous(labels = label_dollar()) +
labs(
title = "Average capital gain rate change",
subtitle = "Orange = before 50% capital gains discount",
x = NULL, y = NULL
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(face = "bold"),
legend.title = element_blank()
)
library(usethis)
usethis::create_package("GoldinGroundOz")
usethis::create_package(".")
getwd()
list.files()
list.dirs()
cl
library(usethis)
usethis::create_package(".")
getwd()
usethis::use_data_raw("data_simulated")
source("D:/Monash_University/ETC5523/GoldinGroundOz/data-raw/data_simulated.R", echo = TRUE)
list.files("data")
data("housepr_income")
head(housepr_income)
devtools::load_all()
install.packages("devtools")
devtools::load_all()
data("housepr_income")
housepr_income
?ggplot2
?heand()
?head()
usethis::use_mit_license()
usethis::use_readme_rmd()
?tidyverse
?head()
devtools::build_readme()
usethis::use_r("run_shinyapp")
usethis::use_directory("inst/shiny")
file.create("inst/shiny/app.R")
usethis::use_package(ggplot2)
usethis::use_package("ggplot2")
library(shiny); runApp('D:/Monash_University/ETC5523/tutorial/w10.R')
runApp('inst/shiny')
View(capital_gain)
runApp('inst/shiny')
runApp('D:/Monash_University/ETC5523/tutorial/w10.R')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
View(capital_gain)
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
View(capital_gain)
runApp('inst/shiny')
runApp('inst/shiny')
devtools::build_readme()
runApp('inst/shiny')
runApp('D:/Monash_University/ETC5523/tutorial/w10.R')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
install.packages("bslib")
install.packages(c("shiny", "bslib"))
shiny::runApp('inst/shiny')
devtools::load_all()
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
runApp('inst/shiny')
usethis::use_package("scales")
devtools::document()
library(devtools)
library(usethis)
devtools::build()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
browseVignettes("GoldinGroundOz")
vignette("simulating-the-gold-in-the-ground")
devtools::build_vignettes()
devtools::build_vignettes()
library(usethis)
usethis::use_pkgdown()
install.packages("ymlthis")
library(ymlthis)
pkgdown_template(path = ".") %>% use_pkgdown_yml()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::clean_site(force = TRUE)
pkgdown::build_site()
pkgdown::clean_site(force = TRUE)
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
devtools::build_vignettes()
setwd("D:/Monash_University/ETC5523/GoldinGroundOz")
devtools::build_vignettes()
usethis::proj_set("D:/Monash_University/ETC5523/GoldinGroundOz")
devtools::build_vignettes()
library(uesthis)
library(usethis)
devtools::build_vignettes()
library(pkdown)
library(pkgdown)
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
usethis::use_vignette("shiny-demo")
shiny::runApp('inst/shiny')
devtools::load_all()
shiny::runApp('inst/shiny')
pkgdown::build_site()
detach("package:GoldinGroundOz", unload = TRUE)
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
unlink("docs", recursive = TRUE)
pkgdown::build_site()
pkgdown::clean_site()
devtools::document()
devtools::build_readme()
devtools::build_vignettes()
setwd("D:/Monash_University/ETC5523/GoldinGroundOz")
devtools::build_vignettes()
getwd()
setwd("D:/Monash_University/ETC5523/GoldinGroundOz")
safe_document <- function(path = ".") {
path <- normalizePath(path, winslash = "/", mustWork = TRUE)
message("ğŸ“„ Rebuilding documentation for: ", path)
devtools::document(pkg = path)
}
safe_document("D:/Monash_University/ETC5523/GoldinGroundOz")
devtools::document()
setwd("D:\\Monash_University\\ETC5523\\GoldinGroundOz")
devtools::build_vignettes()
devtools::build_vignettes()
tools::buildVignettes(dir = ".", tangle = TRUE)
devtools::build()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::clean_site()
pkgdown::build_site()
devtools::build_vignettes()
devtools::build()
devtools::build_vignettes(pkg = normalizePath(".", winslash = "/", mustWork = TRUE))
pkgdown::clean_site()
pkgdown::build_site()
devtools::build_readme()
pkgdown::clean_site()
pkgdown::build_site()
